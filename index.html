<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Speelschema padel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#1976d2">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon-192.png">

  <style>
    body { font-family: system-ui, -apple-system, sans-serif; margin:0; padding:1.5rem; background:#f5f5f5; }
    .app { max-width:520px; margin:0 auto; background:#fff; padding:1.5rem; border-radius:1rem;
           box-shadow:0 4px 12px rgba(0,0,0,0.08); }
    h1 { text-align:center; margin:0 0 0.5rem; }
    .subtitle { text-align:center; color:#555; margin-bottom:1.5rem; font-size:0.9rem; }
    .week-label, .date-label { text-align:center; margin-bottom:0.4rem; }
    .card { background:#fafafa; border-radius:0.75rem; padding:1rem; border:1px solid #e0e0e0; }
    .players { padding-left:1rem; }
    .nav-buttons { display:flex; gap:.5rem; margin-top:1rem; }
    button { flex:1; padding:.6rem; border:none; border-radius:999px; cursor:pointer; }
    .secondary { background:#e0e0e0; }
    .special { background:#2e7d32; color:white; }
  </style>
</head>

<body>
  <div class="app">
    <h1>Speelschema padel</h1>
    <div class="subtitle">
      15-ronden cyclus. Niemand rust twee keer achter elkaar.<br>
      Oudjaarsdag wordt overgeslagen.
    </div>

    <div id="weekLabel"></div>
    <div id="dateLabel"></div>

    <div class="card">
      <h2 id="roundTitle"></h2>

      <div id="noMatch" style="color:#c62828; display:none;"></div>

      <div id="playsBlock">
        <strong>Spelers deze week:</strong>
        <ul id="playsList" class="players"></ul>
      </div>

      <div id="restsBlock">
        <strong>Rust deze week:</strong>
        <ul id="restsList" class="players"></ul>
      </div>

      <div class="nav-buttons">
        <button id="prevWeekBtn" class="secondary">&larr;</button>
        <button id="thisWeekBtn" class="secondary">Vandaag</button>
        <button id="nextWeekBtn">&rarr;</button>
        <button id="nextPlayWeekBtn" class="special">Volgende speelweek</button>
      </div>
    </div>
  </div>

<script>
//
// DEFINITIEF 15-RONDEN-SCHEMA (juiste versie met jouw voorwaarden)
//
const rounds = [
  { round: 1,  plays:["Karel","Damir","Marco","Leon"],      rests:["John","Ramon"] },
  { round: 2,  plays:["Karel","Marco","Ramon","John"],      rests:["Damir","Leon"] },
  { round: 3,  plays:["Damir","Marco","Ramon","Leon"],      rests:["John","Karel"] },
  { round: 4,  plays:["Karel","Ramon","Leon","John"],       rests:["Damir","Marco"] },
  { round: 5,  plays:["Karel","Marco","Leon","Ramon"],      rests:["Damir","John"] },
  { round: 6,  plays:["Damir","Leon","John","Ramon"],       rests:["Karel","Marco"] },
  { round: 7,  plays:["Karel","Damir","Ramon","Leon"],      rests:["John","Marco"] },
  { round: 8,  plays:["Damir","Marco","Ramon","John"],      rests:["Karel","Leon"] },
  { round: 9,  plays:["Karel","Damir","Leon","John"],       rests:["Marco","Ramon"] },
  { round:10,  plays:["Karel","Marco","Ramon","Leon"],      rests:["Damir","John"] },
  { round:11,  plays:["Damir","Marco","Leon","John"],       rests:["Karel","Ramon"] },
  { round:12,  plays:["Karel","Damir","Ramon","John"],      rests:["Leon","Marco"] },
  { round:13,  plays:["Karel","Marco","Leon","John"],       rests:["Damir","Ramon"] },
  { round:14,  plays:["Damir","Ramon","Leon","John"],       rests:["Karel","Marco"] },
  { round:15,  plays:["Karel","Damir","Marco","John"],      rests:["Leon","Ramon"] }
];

const MS = 86400000;
const baseWeekStart = new Date(2025,10,27);

function toMid(d){ return new Date(d.getFullYear(), d.getMonth(), d.getDate()); }

function matchDate(i){
  return new Date(baseWeekStart.getTime() + i*7*MS + 6*MS);
}

function skip(d){
  return (d.getMonth()==11 && d.getDate()==31);
}

function skippedBefore(i){
  let s=0;
  for(let w=0; w<i; w++) if(skip(matchDate(w))) s++;
  return s;
}

function roundFor(i){
  let eff = i - skippedBefore(i);
  return rounds[(eff % rounds.length)];
}

function render(){
  let ws = document.getElementById("weekLabel");
  let ds = document.getElementById("dateLabel");
  let title = document.getElementById("roundTitle");

  let ml = matchDate(currentWeekIndex);
  let wkStart = new Date(baseWeekStart.getTime() + currentWeekIndex*7*MS);

  ws.innerText = "Week " + currentWeekIndex + " (" +
                 wkStart.toLocaleDateString() + " t/m " +
                 ml.toLocaleDateString() + ")";

  ds.innerText = "Speeldag: " + ml.toLocaleDateString();

  let no = document.getElementById("noMatch");
  let playsBlock = document.getElementById("playsBlock");
  let restsBlock = document.getElementById("restsBlock");
  let playsList = document.getElementById("playsList");
  let restsList = document.getElementById("restsList");

  playsList.innerHTML = "";
  restsList.innerHTML = "";

  if(skip(ml)){
    title.innerText = "Geen speelweek (Oudejaarsdag)";
    no.style.display = "block";
    playsBlock.style.display = "none";
    restsBlock.style.display = "none";
    no.innerText = "Oudejaarsdag valt op woensdag, deze week wordt niet gespeeld.";
    return;
  }

  let r = roundFor(currentWeekIndex);

  title.innerText = "Ronde " + r.round;
  no.style.display = "none";
  playsBlock.style.display = "block";
  restsBlock.style.display = "block";

  r.plays.forEach(p=>{
    let li=document.createElement("li");
    li.innerText=p;
    playsList.appendChild(li);
  });

  r.rests.forEach(p=>{
    let li=document.createElement("li");
    li.innerText=p;
    restsList.appendChild(li);
  });
}

function weekIndexFromDate(d){
  let diff = toMid(d) - toMid(baseWeekStart);
  return Math.floor(diff/MS/7);
}

let currentWeekIndex = weekIndexFromDate(new Date());

document.getElementById("prevWeekBtn").onclick = ()=>{ currentWeekIndex--; render(); };
document.getElementById("nextWeekBtn").onclick = ()=>{ currentWeekIndex++; render(); };
document.getElementById("thisWeekBtn").onclick = ()=>{ currentWeekIndex = weekIndexFromDate(new Date()); render(); };
document.getElementById("nextPlayWeekBtn").onclick = ()=>{
  let i=currentWeekIndex+1;
  while(skip(matchDate(i))) i++;
  currentWeekIndex=i; render();
};

render();
</script>

</body>
</html>
